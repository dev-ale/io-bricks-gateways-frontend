webpackJsonp([1],[,function(e,t,n){function s(e){n(5)}var a=n(9)(n(4),n(10),s,null,null);e.exports=a.exports},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),a=n(1),i=n.n(a);s.a.use(i.a),s.a.config.productionTip=!1,new s.a({el:"#app",template:"<App/>",components:{App:i.a}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app",data:function(){return{client:null,brokerOnline:!1,gateways:[]}},created:function(){this.client=new Paho.MQTT.Client("mqtt.brick.li",9001,"clientId"),this.client.onConnectionLost=this.onConnectionLost,this.client.onMessageArrived=this.onMessageArrived,this.client.connect({onSuccess:this.onConnect})},methods:{onConnectionLost:function(e){0!==e.errorCode&&console.log("onConnectionLost:"+e.errorMessage)},onMessageArrived:function(e){if(e.destinationName.endsWith("/scan"),e.destinationName.endsWith("/state")){console.log("neuer state");var t=JSON.parse(e.payloadString);if(console.log(t),this.gateways.some(function(e){return e.name===t.name}))if(!1===t.online){console.log("offline called");var n=this.gateways.findIndex(function(e){return e.name===t.name});this.gateways.splice(n,1),console.log(this.gateways)}else{console.log("matched and updatet gateway: "+t.name);var s=this.gateways.findIndex(function(e){return e.name===t.name});t.loading=!1,this.$set(this.gateways,s,t)}else{console.log("new gateway: "+t.name);this.gateways.findIndex(function(e){return e.name===t.name});t.loading=!1,this.gateways.push(t)}}},onConnect:function(){console.log("ONCONNECT ausgeführt"),this.client.subscribe("devices/#"),this.client.subscribe("gateways/#"),this.brokerOnline=!0},subscribe:function(e){console.log("SUBSCRIBE auf: "+e),console.log("subscribed to "+e)},publish:function(e,t){console.log("PUBLISH auf: "+t+" Message: "+e);var n=new Paho.MQTT.Message(e);n.destinationName=t,this.client.send(n)},scan:function(e){console.log("SCAN ausgeführt");var t=e.name,n=(new Date).toJSON().substring(10,19).replace("T"," ");this.publish(n,"gateways/"+t+"/scan"),e.loading=!0,setTimeout(function(){e.loading=!1},8e3)}}}},function(e,t){},,,,,function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("nav",{staticClass:"blue-grey"},[n("div",{staticClass:"nav-wrapper"},[n("a",{staticClass:"brand-logo center",attrs:{href:"#"}},[e._v("iot bricks ble - gateways"),e.brokerOnline?e._e():n("span",{staticClass:"badge red black-text"},[e._v("Offline")])])])]),e._v(" "),n("div",{attrs:{id:"app"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col s12 m6 offset-m3"},[0===this.gateways.length?n("h2",[e._v("no gateways available")]):e._e(),e._v(" "),this.gateways.length>0?n("div",e._l(e.gateways,function(t){return n("div",{key:t.name,staticClass:"card blue-grey darken-1 hoverable"},[n("div",{staticClass:"card-content white-text"},[n("span",{staticClass:"card-title"},[n("span",{staticClass:"orange-text",staticStyle:{"font-weight":"bold"}},[e._v(e._s(t.name))])]),e._v(" "),t.loading?n("div",{staticClass:"progress orange accent-2"},[n("div",{staticClass:"indeterminate orange accent-1"})]):e._e(),e._v(" "),t.loading?e._e():n("p",{staticStyle:{"font-size":"x-large"}},[e._v("Connected Devices:")]),e._v(" "),t.loading?n("p",{staticStyle:{"font-size":"x-large"}},[e._v("Scanning for new Devices")]):e._e(),e._v(" "),e._l(t.connectedDevices,function(s){return t.loading?e._e():n("ul",{key:s},[n("li",{staticStyle:{"font-size":"large"}},[e._v(e._s(s))])])})],2),e._v(" "),n("div",{staticClass:"card-action"},[n("a",{staticClass:"waves-effect waves-light btn orange black-text",on:{click:function(n){return e.scan(t)}}},[e._v("Scan for new Devices")])])])}),0):e._e()])])])])},staticRenderFns:[]}}],[3]);
//# sourceMappingURL=app.430c0c641b385c64cb65.js.map