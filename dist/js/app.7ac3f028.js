(function(e){function t(t){for(var a,s,i=t[0],c=t[1],l=t[2],d=0,f=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&f.push(o[s][0]),o[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},o={app:0},r=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("Navbar",{attrs:{broker:e.brokerOnline}}),n("v-main",[n("v-container",{staticClass:"app",attrs:{fluid:""}},[n("v-row",[n("v-col",{attrs:{align:"center"}},[0===this.gateways.length?n("div",[n("p",[e._v("no Gateways connected")])]):e._e(),this.gateways.length>0?n("div",[n("p",[e._v("Gateways")])]):e._e()])],1),n("v-row",e._l(e.gateways,(function(t){return n("v-card",{key:t.name,staticClass:"mx-auto mb-6",attrs:{width:"300"}},[n("v-card-text",[t.loading?e._e():n("p",{staticClass:"green--text"},[e._v("Online ")]),t.loading?n("p",{staticClass:"orange--text"},[e._v("Searching ")]):e._e(),n("p",{staticClass:"display-1 text--primary"},[e._v(" "+e._s(t.name)+" ")]),0!==t.connectedDevices.length||t.loading?e._e():n("p",[e._v("No connected devices")]),!t.loading&&t.connectedDevices.length>0?n("div",[n("p",[e._v("Connected Devices:")]),e._l(t.connectedDevices,(function(t){return n("v-list",{key:t,attrs:{dense:"",disabled:""}},[n("v-list-item",[n("v-list-item-icon",[n("v-icon",{attrs:{color:"primary"}},[e._v("mdi-bluetooth")])],1),n("v-list-item-content",{staticStyle:{"font-size":"large"}},[e._v("Brick "+e._s(t))])],1)],1)}))],2):e._e(),t.loading?n("div",[n("p",[e._v("Scanning for Devices")]),n("v-progress-linear",{attrs:{indeterminate:"",color:"blue darken-2"}})],1):e._e()]),n("v-card-actions",[t.lastScan?n("span",{staticClass:"grey--text"},[e._v("Last Scan: "+e._s(t.lastScan))]):e._e(),n("v-spacer"),t.loading?e._e():n("v-btn",{attrs:{dark:"",color:"red accent-2"},on:{click:function(n){return e.scan(t)}}},[e._v(" Scan ")])],1)],1)})),1)],1),n("Footer")],1)],1)},r=[],s=(n("c740"),n("45fc"),n("a434"),n("b0c0"),n("ac1f"),n("8a79"),n("5319"),n("bf19"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app-bar",{attrs:{app:"",color:"teal",dark:""}},[n("v-btn",{attrs:{href:"https://github.com/",target:"_blank",text:""}},[n("span",{staticClass:"mr-2"},[e._v("v0.4")])]),n("v-spacer"),n("div",[n("v-toolbar-title",[n("strong",[e._v("iot bricks "),n("span",{staticClass:"blue--text text--darken-4"},[e._v("ble")])])])],1),n("v-spacer"),e.broker?n("v-btn",{staticClass:"green",attrs:{href:"http://mqtt.brick.li:8888/status",target:"_blank"}},[n("span",{staticClass:"mr-2"},[e._v("Online")])]):e._e(),e.broker?e._e():n("v-btn",{staticClass:"red",attrs:{href:"http://mqtt.brick.li:8888/status",target:"_blank"}},[n("span",{staticClass:"mr-2"},[e._v("Offline")])])],1)}),i=[],c={props:{broker:Boolean},name:"Navbar"},l=c,u=n("2877"),d=n("6544"),f=n.n(d),p=n("40dc"),v=n("8336"),g=n("2fa4"),h=n("2a7f"),b=Object(u["a"])(l,s,i,!1,null,"c0cafd30",null),m=b.exports;f()(b,{VAppBar:p["a"],VBtn:v["a"],VSpacer:g["a"],VToolbarTitle:h["a"]});var _=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-footer",{attrs:{dark:"",padless:"",fixed:""}},[n("v-card",{staticClass:"flex",attrs:{flat:"",tile:""}},[n("v-card-title",{staticClass:"teal"},[e._v(" "+e._s((new Date).getFullYear())+" — FHNW IP5 "),n("v-spacer"),n("v-btn",{staticClass:"mx-4",attrs:{href:"https://github.com/",target:"_blank",dark:"",icon:""}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-github ")])],1)],1)],1)],1)},w=[],y=n("b0af"),C=n("99d9"),k=n("553a"),S=n("132d"),V={},x=Object(u["a"])(V,_,w,!1,null,null,null),O=x.exports;f()(x,{VBtn:v["a"],VCard:y["a"],VCardTitle:C["c"],VFooter:k["a"],VIcon:S["a"],VSpacer:g["a"]});var N={name:"App",components:{Footer:O,Navbar:m},data:function(){return{client:null,brokerOnline:!1,gateways:[]}},created:function(){this.client=new Paho.MQTT.Client("mqtt.brick.li",9001,"webclient"+parseInt(100*Math.random(),10)),this.client.onConnectionLost=this.onConnectionLost,this.client.onMessageArrived=this.onMessageArrived,this.client.connect({onSuccess:this.onConnect})},methods:{onConnectionLost:function(e){0!==e.errorCode&&console.log("onConnectionLost:"+e.errorMessage)},onMessageArrived:function(e){if(e.destinationName.endsWith("/scan"),e.destinationName.endsWith("/state")){var t=JSON.parse(e.payloadString);if(console.log("New State for "+t.name),console.log(t),this.gateways.some((function(e){return e.name===t.name}))){if(console.log(t.online),"false"===t.online){console.log("offline called");var n=this.gateways.findIndex((function(e){return e.name===t.name}));this.gateways.splice(n,1),console.log(this.gateways)}else if("true"===t.online){console.log("matched and updatet gateway: "+t.name+t.online);var a=this.gateways.findIndex((function(e){return e.name===t.name}));t.loading=!1,this.$set(this.gateways,a,t)}}else"false"===t.online?console.log("nothing to delete"):(console.log("new gateway: "+t.name),t.loading=!1,this.gateways.push(t))}},onConnect:function(){console.log("ONCONNECT ausgeführt"),this.client.subscribe("devices/#"),this.client.subscribe("gateways/#"),this.brokerOnline=!0},subscribe:function(e){console.log("SUBSCRIBE auf: "+e),console.log("subscribed to "+e)},publish:function(e,t){console.log("PUBLISH auf: "+t+" Message: "+e);var n=new Paho.MQTT.Message(e);n.destinationName=t,this.client.send(n)},scan:function(e){console.log(this.client.name),console.log("SCAN ausgeführt");var t=e.name,n=(new Date).toJSON().substring(10,17).replace("T"," ");this.publish(n,"gateways/"+t+"/scan"),e.loading=!0,console.log(e.connectedDevices),setTimeout((function(){e.loading=!1,e.lastScan=n}),8e3)}}},j=N,M=(n("034f"),n("7496")),T=n("62ad"),I=n("a523"),P=n("8860"),A=n("da13"),L=n("5d23"),B=n("34c3"),D=n("f6c4"),F=n("8e36"),E=n("0fd9"),$=Object(u["a"])(j,o,r,!1,null,null,null),q=$.exports;f()($,{VApp:M["a"],VBtn:v["a"],VCard:y["a"],VCardActions:C["a"],VCardText:C["b"],VCol:T["a"],VContainer:I["a"],VIcon:S["a"],VList:P["a"],VListItem:A["a"],VListItemContent:L["a"],VListItemIcon:B["a"],VMain:D["a"],VProgressLinear:F["a"],VRow:E["a"],VSpacer:g["a"]});var J=n("f309");a["a"].use(J["a"]);var W=new J["a"]({}),z=n("9483");Object(z["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),a["a"].config.productionTip=!1,new a["a"]({vuetify:W,render:function(e){return e(q)}}).$mount("#app")},"85ec":function(e,t,n){}});
//# sourceMappingURL=app.7ac3f028.js.map